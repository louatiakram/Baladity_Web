{% extends 'base-front.html.twig' %}

{% block title %}Modifier avis{% endblock %}

{% block body %}
<section class="section">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Modifier avis</h5>
                    <form method="POST" action="{{ path('modifierAvis', {'id': avis.getIdAvis()}) }}" enctype="multipart/form-data">
                        {{ form_start(form, {'attr': {'class': 'row g-3', 'novalidate': 'novalidate'}}) }}

                        <div class="mb-3">
                            <label for="inputNote" class="form-label">Note</label>
                            <!-- Star rating -->
                            <div class="star-rating">
                                <i class="star fas fa-star" data-rating="1"></i>
                                <i class="star fas fa-star" data-rating="2"></i>
                                <i class="star fas fa-star" data-rating="3"></i>
                                <i class="star fas fa-star" data-rating="4"></i>
                                <i class="star fas fa-star" data-rating="5"></i>
                            </div>
                            <!-- Hidden field for storing the rating value -->
                            {{ form_row(form.note_avis, {'attr': {'class': 'hidden-rating'}}) }}
                        </div>

                        <div class="mb-3">
                            <label for="inputCommentaire" class="form-label">Commentaire</label>
                            {{ form_widget(form.commentaire_avis, {'attr': {'class': 'form-control'}}) }}
                        </div>
                        <input type="hidden" name="id_equipement" value="{{ avis.getEquipement().getIdEquipement() }}">
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary">Modifier</button>
                            <a href="{{ path('avis_show_front', {'id': avis.getEquipement().getIdEquipement()}) }}" class="btn btn-secondary">Annuler</a>
                        </div>
                        {{ form_end(form) }}
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Style for star rating -->
<style>
    /* Default color of star icons */
    .star {
        color: gray; /* or any other color */
    }

    /* Selected color of star icons */
    .star.selected {
        color: yellow; /* or any other color */
    }
</style>

<!-- JavaScript for star rating -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const stars = document.querySelectorAll(".star");

        stars.forEach((star, index) => {
            star.addEventListener("click", function() {
                const rating = this.getAttribute("data-rating");

                // Highlight selected stars and preceding stars
                stars.forEach((s, i) => {
                    if (i <= index) {
                        s.classList.add("selected");
                    } else {
                        s.classList.remove("selected");
                    }
                });

                // Update the value of the hidden input field
                const hiddenRating = document.querySelector(".hidden-rating");
                hiddenRating.value = rating;
            });
        });
    });
</script>
{% endblock %}
